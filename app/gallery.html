<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
	<meta name="keywords" content="gallery, lisp, rgb, texture generation, webgl">
	
	<title>Metaheuristic explorer web interface</title>
	<script src="glMatrix-0.9.5.min.js"></script>
	<script src="utils.js"></script>
	<script src="webgl-utils.js"></script>
	<script src="webgl-entities.js"></script>
	<link href="bootstrap.min.css" rel="stylesheet">
	<link href="site.css" rel="stylesheet">
	
	<style type="text/css">
		canvas {
		padding-left: 40px; padding-top: 40px }
	</style>
  </head>

	<body onload="startupDraw()">
		<div class="navbar navbar-default navbar-fixed-top" role="navigation" style="background-color: indigo">
			<div class="container">
				<div class="navbar-collapse">
				  <ul class="nav navbar-nav">
					<li><a style="text-shadow: none;" href="/index.html">Home</a></li>
					<li><a style="text-shadow: none;" href="/about.html">About</a></li>
					<li><a style="text-shadow: none;" href="/blog.html">Blog</a></li>								
					<li><a style="text-shadow: none;" href="/contact.html">Contact</a></li>
					<li class="dropdown">              
					  <a style="text-shadow: none;" href="/example-tree-languages.html" class="dropdown-toggle" data-toggle="dropdown">Examples <span class="caret"></span></a>
					  <ul class="dropdown-menu" role="menu">
						<li><a style="text-shadow: none;" href="/example-tree-languages.html">Mono images</a></li>
						<li><a style="text-shadow: none;" href="/example-tree-languages-rgb.html">RGB vector mix</a></li>
						<li><a style="text-shadow: none;" href="/example-animation-rgb.html">RGB vector animated</a></li>
						<li><a style="text-shadow: none;" href="/example-vrp.html">VRP</a></li>
						<li class="active"><a style="text-shadow: none;" href="/gallery.html" disabled="disabled">Gallery</a></li>
					  </ul>
					</li>
					<li class="dropdown">              
					  <a style="text-shadow: none;" href="/example-languages.html" class="dropdown-toggle" data-toggle="dropdown">Search <span class="caret"></span></a>
					  <ul class="dropdown-menu" role="menu">
						<li><a style="text-shadow: none;" href="/example-fx.html">F(x) search</a></li>
						<li><a style="text-shadow: none;" href="/example-bw.html">F(xy) search</a></li>
						<li><a style="text-shadow: none;" href="/example-rgb.html">RGB image search</a></li>
						<li><a style="text-shadow: none;" href="/example-rgbt.html">RGBT</a></li>
						<li><a style="text-shadow: none;" href="/example-vrp.html">VRP</a></li>
					  </ul>
					</li>
				  </ul>
				</div>
			</div>
		</div>
			
		<div class="container" style="padding-top: 20px">
			<div>
				<div id="main-div" style="margin-top: 70px; max-width: 800px; ">
					<div id="parents-div" class="view-container" style="margin-bottom: 5px">
						<canvas id="gallery0" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery1" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery2" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery3" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery4" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery5" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery6" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery7" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery8" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery9" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery10" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery11" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>		
						<canvas id="gallery12" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery13" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>				
						<canvas id="gallery14" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
						<canvas id="gallery15" width="150" height="150" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>		
					</div>
				</div>
			</div>
		</div>
	</body>

	<script src="jquery-1.11.1.min.js"></script>	
	<script src="bootstrap.min.js"></script>	
		
	<script>		
		var galleryDictionary = {};
		var gallerySize = 16;
		
		function startupDraw () {			
			for (var i=0; i< gallerySize; i++) {
				var canvasId = "gallery" + i.toString();
				createFunctionGeneric(canvasId, { index: i.toString() }, "/messageGalleryGetElement");
			}
		}

		function allowDrop(ev) {
			ev.preventDefault();
		}

		function drag(ev) {
			ev.dataTransfer.setData("Text", JSON.stringify(galleryDictionary[ev.target.id]));
		}
		
		function drop(ev) {
			ev.preventDefault();
			var result = JSON.parse(ev.dataTransfer.getData("Text"));
			galleryDictionary[ev.target.id] = result;
			if (result=="default") alert("Default error");
			var canvasId = ev.target.id;
			
			if (result[3].trim() == "entity-bw") {
				initWebGLBW(canvasId, result[2]);
				drawEntityImageBW();
			}
			else if (result[3].trim() == "entity-rgb") {
				initWebGLRGB(canvasId, result[2]);
				drawEntityImageRGB();
			}
			else if (result[3].trim() == "entity-rgb-animate") {
				setInterval(
					function () {				
						initWebGLRGBAnimate(canvasId, result[2]);
						drawEntityImageRGBAnimate();					
					}, 
					200);				
			}	
		}
		
		function createFunctionGeneric(canvasId, arguments, message) {
			$.ajax({
				type : 'GET',
				url : message,
				data : arguments,
				dataType : "text",
				success : function(data) {
					var result = data.split("|");
					galleryDictionary[canvasId] = result;
					
					if (result[3].trim() == "entity-bw") {
						initWebGLBW(canvasId, result[2]);
						drawEntityImageBW();
					}
					else if (result[3].trim() == "entity-rgb") {
						initWebGLRGB(canvasId, result[2]);
						drawEntityImageRGB();
					}
					else if (result[3].trim() == "entity-rgb-animate") {
						setInterval(
							function () {				
								initWebGLRGBAnimate(canvasId, result[2]);
								drawEntityImageRGBAnimate();					
							}, 
							200);				
					}					
				},
				error : function(data) {
					console.log('Call failed');
				}
			});
		};
		
		function menuCallbackPrefix(name, index) {			
			if (index==0) {
				var url_safe_language = encodeURIComponent(galleryDictionary[name][3]);
				var url_safe_a = galleryDictionary[name][0];
				var url_safe_b = galleryDictionary[name][1];
				var url_safe_c = galleryDictionary[name][2];
				var url = "http://gpexplorer.ddns.net/messageView?language=" + url_safe_language + "&a=" + url_safe_a + "&b=" + url_safe_b + "&c=" + url_safe_c;				
				window.open (url, "Object inspect");
			}
			else if (index==1) {
				$.ajax({
						type : 'GET',
						url : "/messageLike",
						data : { language: galleryDictionary[name][3], a: galleryDictionary[name][0], b: galleryDictionary[name][1], c: galleryDictionary[name][2]},
						dataType : "text",
						success : function(data) { },
						error : function(data) {
							console.log('Like call failed');
						}
					});			
			}
			else if (index==2) {
				$.ajax({
						type : 'GET',
						url : "/messageDislike",
						data : { language: galleryDictionary[name][3], a: galleryDictionary[name][0], b: galleryDictionary[name][1], c: galleryDictionary[name][2]},
						dataType : "text",
						success : function(data) { },
						error : function(data) {
							console.log('Like call failed');
						}
					});			
			}			
			else if (index==3) {
				$.ajax({
						type : 'GET',
						url : "/messageSend",
						data : { language: entitiesDictionary[name][3], a: entitiesDictionary[name][0], b: entitiesDictionary[name][1], c: entitiesDictionary[name][2]},
						dataType : "text",
						success : function(data) { },
						error : function(data) {
							console.log('Send call failed');
						}
					});
			}
		}
	</script>
	
	<div id="context_menu" style="border:1px solid black;background-color:#EEEEEE;visibility:hidden;position:absolute;line-height:30px; padding-left: 0px;">
		<div><input type="button" value="Open" onclick="menuCallbackPrefix(globalSelectedIndex, 0)" style="width: 100px"/></div>
		<div><input type="button" value="Like" onclick="menuCallbackPrefix(globalSelectedIndex, 1)" style="width: 100px"/></div>
		<div><input type="button" value="Dislike" onclick="menuCallbackPrefix(globalSelectedIndex, 2)" style="width: 100px"/></div>
		<div><input type="button" value="Send" onclick="menuCallbackPrefix(globalSelectedIndex, 3)" style="width: 100px"/ disabled></div>
	</div>

	<script type="text/javascript">
		initializeContextMenuOn("gallery", "context_menu", menuSetCallback);
	</script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-54522358-1', 'auto');
	  ga('send', 'pageview');
	</script>
</html>