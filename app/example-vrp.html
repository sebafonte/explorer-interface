<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

	<title>Genetic explorer test example</title>
	<script src="glMatrix-0.9.5.min.js"></script>
	<script src="webgl-utils.js"></script>
	<script src="webgl-entities.js"></script>
	<link href="bootstrap.min.css" rel="stylesheet">
  </head>

	<body onload="startupDraw()">
		<div class="navbar navbar-default navbar-fixed-top" role="navigation" style="background-color: indigo">
			<div class="container">
				<div class="navbar-collapse">
				  <ul class="nav navbar-nav">
					<li><a style="text-shadow: none;" href="/index.html">Home</a></li>
					<li><a style="text-shadow: none;" href="/about.html">About</a></li>
					<li><a style="text-shadow: none;" href="/blog.html">Blog</a></li>								
					<li><a style="text-shadow: none;" href="/contact.html">Contact</a></li>
					<li class="dropdown">              
					  <a style="text-shadow: none;" href="/example-tree-languages.html" class="dropdown-toggle" data-toggle="dropdown">Examples <span class="caret"></span></a>
					  <ul class="dropdown-menu" role="menu">
						<li><a style="text-shadow: none;" href="/example-tree-languages.html">Mono images</a></li>
						<li class="active"><a style="text-shadow: none;" href="/example-vrp.html">VRP</a></li>
						<li><a style="text-shadow: none;" href="/gallery.html" disabled="disabled">Gallery</a></li>
					  </ul>
					</li>
				  </ul>
				</div>
			</div>
		</div>
			
		<div class="container" style="padding-top: 60px">
			<div>
				<div id="main-div" style="max-width: 613px; border: 1px solid lightgray">
					<div>
						<div style="display: flex; border: 1px solid black; ">
							<div>
								<canvas style="border: 1px solid black;" id="parent0" width="256" height="256" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
							</div>
							<div id="configuration-1-div" class="view-container">
								<form>
									<div style="margin-top: 20px; padding-left: 15px">
										<div style="display: block">
											<div>
												Algorithm
												<select id="algorithm-select" value="lisp-math-function-xy">
													<option value="clark">clark-and-wright-savings</option>
													<option value="generational-random">generational-random</option>
													<option value="steady-state-random">steady-state-random</option>
													<option value="generational-clark">generational-clark</option>
													<option value="steady-state-clark">steady-state-clark</option>
												</select>
											</div>
											<div>
												Objective
												<select id="fitness-select" disabled>
													<option value="Function xy">None</option>
													<option value="Function x">Colorfull</option>
												</select>
											</div>
										</div>			
										<div style="display: flex">									
											<div style="margin-left: 5px">
												Max time
												<input type="text" value="1" disabled/>
											</div>
										</div>
										<div style="display: flex">									
											<div style="margin-left: 5px">
												Population size
												<input type="text" value="1" disabled/>
											</div>
										</div>										
										<div style="display: flex">									
											<div style="margin-left: 5px">
												Max generations
												<input type="text" value="1" disabled/>
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
						<div style="display: flex; border: 1px solid black; ">
							<canvas id="parent1" style="border: 1px solid black;" width="256" height="256" draggable="true" ondragstart="drag(event)" ondragover="allowDrop(event)" ondrop="drop(event)"></canvas>
							<div id="configuration-1-div" class="view-container">
								<form>
									<div style="display: block; margin-top: 20px; padding-left: 15px">
										<div>
											Algorithm
											<select id="algorithm-select" value="lisp-math-function-xy">
												<option value="clark">clark-and-wright-savings</option>
												<option value="generational-random">generational-random</option>
												<option value="steady-state-random">steady-state-random</option>
												<option value="generational-clark">generational-clark</option>
												<option value="steady-state-clark">steady-state-clark</option>
											</select>
										</div>
										<div>
											Objective
											<select id="fitness-select" disabled>
												<option value="Default VRP">Default VRP</option>
											</select>
										</div>
										<div style="margin-left: 5px">
											Max time
											<input type="text" value="1" disabled/>
										</div>									
									</div>										
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>

	<script src="jquery-1.11.1.min.js"></script>	
	<script src="bootstrap.min.js"></script>	
		
	<script>
		var entitiesDictionary = {};
			
		function allowDrop(ev) {
			ev.preventDefault();
		}

		function drag(ev) {
			ev.dataTransfer.setData("Text", ev.target.id);
		}

		function drop(ev) {
			ev.preventDefault();
			var value = ev.dataTransfer.getData("Text");
			var result = entitiesDictionary[value];
			registerObject(ev.target.id, result);
			if (result=="default") alert("Default error");
			initWebGL(ev.target.id, result[1]);
		}
		
		function registerObject(id, obj) {
			entitiesDictionary[id] = obj;
		}
		
		function defaultError () {
			alert("Default error");
		}
		
		var startupDraw = function () {			
			createFunctionCallCreateDefault("parent0");
			createFunctionCallCreateDefault("parent1");
		};

		function createFunctionCallCreateDefault(name) {
			createFunctionGeneric(name, { language: "vrp-list-language" }, "/messageCreateDefault");
		}
		
		function initializeParameters(parentId) {
			function createTaskParameters(parentId) {				
				// Get default object with these properties (still hardcoded here, soon will be getted from server)
				var properties = "((fitness-evaluator (cities-description demand-description back-to-depot max-capacity infeasible-penalty))" + 
								 " (algorithm (population-size max-generations)))";
				var result = defaultObjectGetCall({name: "default-vrp-task", properties: properties }});
				registerObject(parentId, result);
				createEditorForProperties(parentId, result);
			}
			
			createTaskParameters();
		};
		
		initializeParameters();
	</script>		
</html>