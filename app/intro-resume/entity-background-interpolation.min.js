function BackgroundInterpolationObject(t,e,i){this.entity=t,this.globalScale=1,this.globalXRef=1,this.globalYRef=1,this.effects=i,this.frameSelector=new NextFrameSelector(e),this.wiggle=.2}function RandomFrameSelector(t){this.timeFrame=t,this.indexA=0,this.indexB=0,this.nextFrame=function(t){return Math.floor(Math.random()*t)},this.initializeInterpolation=function(t){this.indexA=Math.floor(Math.random()*t),this.indexA=this.indexB,this.indexB=this.nextFrame(t),this.lastUpdate=timerValue()},this.updateInterpolationValues=function(t){var e=timerValue();e-this.lastUpdate>this.timeFrame&&(this.indexA=this.indexB,this.indexB=this.nextFrame(t),this.lastUpdate=e)}}function NextFrameSelector(t){this.timeFrame=t,this.indexA=0,this.indexB=0,this.nextFrame=function(){return Math.floor(this.indexB+1)},this.initializeInterpolation=function(t){this.indexA=0,this.indexA>=t&&(this.indexA=0),this.indexB=this.nextFrame(t),this.indexB>=t&&(this.indexB=0),this.lastUpdate=timerValue()},this.updateInterpolationValues=function(t){var e=timerValue();e-this.lastUpdate>this.timeFrame&&(this.indexA=this.indexB,this.indexA>=t&&(this.indexA=0),this.indexB=this.nextFrame(t),this.indexB>=t&&(this.indexB=0),this.lastUpdate=e)}}var RGBBackgroundInterpolationVertexShaderSrc="attribute vec3 aVertexPosition; attribute vec2 aTextureCoord; uniform mat4 uMVMatrix; uniform mat4 uPMatrix; varying float xx, yy; void main(void) { 	vec2 coord = aTextureCoord; 	gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 2.0); 	xx = clamp(aVertexPosition.x,0.0,1.0); 	yy = clamp(aVertexPosition.y,0.0,1.0); }",RGBBackgroundInterpolationFragmentShaderSrc="precision mediump float; varying float xx; varying float yy; uniform float indexA; uniform float indexB; uniform float aa; uniform float va; uniform float vb; uniform float vc; uniform float vd; uniform float time; uniform float faderValue; uniform float wiggle; vec3 veccos(in vec3 a) { return vec3(cos(a.x), cos(a.y), cos(a.z)); } vec3 vecsin(in vec3 a) { return vec3(sin(a.x), sin(a.y), sin(a.z)); } vec3 vectan(in vec3 a) { return vec3(tan(a.x), tan(a.y), tan(a.z)); } vec3 vecabs(in vec3 a) { return vec3(abs(a.x), abs(a.y), abs(a.z)); } vec3 vecsqr(in vec3 a) { return vec3(a.x * a.x, a.y * a.y, a.z * a.z); } vec3 vecadd(in vec3 a, in vec3 b) { return vec3(a.x + b.x, a.y + b.y, a.z + b.z); } vec3 vecsubstract(in vec3 a, in vec3 b) { return vec3(a.x - b.x, a.y - b.y, a.z - b.z); } vec3 vecmultiply(in vec3 a, in vec3 b) { return vec3(a.x * b.x, a.y * b.y, a.z * b.z); } vec3 vecdiv(in vec3 a, in vec3 b) { return vec3(a.x / b.x, a.y / b.y, a.z / b.z); } vec3 createvector(in float a, in float b, in float c) { return vec3(a, b, c); } vec3 veccolormap(in vec3 a, in vec3 b, in vec3 c) { return createvector(a.x / 10.0, b.x / 10.0, c.x / 10.0); } void main(void) {  	float a = aa; 	float x = xx * 10.0, y = yy * 10.0; 	x += sin(time * 4.0 + 1.0 * 3.1415 * x) * wiggle; 	y += sin(time * 4.0 + 1.0 * 3.1415 * y) * wiggle; 	vec3 vaa, vbb;  FUNCIONES 	gl_FragColor = vec4((vaa.x * a + vbb.x * (1.0 - a)) * faderValue, (vaa.y * a + vbb.y * (1.0 - a)) * faderValue, (vaa.z * a + vbb.z * (1.0 - a)) * faderValue, 1.0); }";BackgroundInterpolationObject.prototype.initialize=function(t){this.mvMatrix=mat4.create(),this.pMatrix=mat4.create(),this.initBuffersRGB(t),this.initShadersRGBAnimate(t),this.frameSelector.initializeInterpolation(this.entity.length)},BackgroundInterpolationObject.prototype.render=function(t){var e=timerValue();t.useProgram(this.shaderProgram);for(var i in this.effects)this.effects[i].apply(this);this.frameSelector.updateInterpolationValues(this.entity.length);var a=t.getUniformLocation(this.shaderProgram,"va");t.uniform1f(a,e),a=t.getUniformLocation(this.shaderProgram,"vb"),t.uniform1f(a,globalVb),a=t.getUniformLocation(this.shaderProgram,"vc"),t.uniform1f(a,globalVc),a=t.getUniformLocation(this.shaderProgram,"vd"),t.uniform1f(a,globalVd),a=t.getUniformLocation(this.shaderProgram,"time"),t.uniform1f(a,timerValue()),a=t.getUniformLocation(this.shaderProgram,"faderValue"),t.uniform1f(a,this.transparencyValue);var r=(timerValue()-this.frameSelector.lastUpdate)/this.frameSelector.timeFrame;a=t.getUniformLocation(this.shaderProgram,"indexA"),t.uniform1f(a,this.frameSelector.indexA),a=t.getUniformLocation(this.shaderProgram,"indexB"),t.uniform1f(a,this.frameSelector.indexB),a=t.getUniformLocation(this.shaderProgram,"wiggle"),t.uniform1f(a,this.wiggle),a=t.getUniformLocation(this.shaderProgram,"aa");var o=1>r?r:1;t.uniform1f(a,1-o),t.disable(t.DEPTH_TEST),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),mat4.identity(this.pMatrix),mat4.ortho(0,1,0,1,.1,100,this.pMatrix),mat4.identity(this.mvMatrix),mat4.translate(this.mvMatrix,[0,0,-.2]),t.bindBuffer(t.ARRAY_BUFFER,this.squareVertexPositionBuffer),t.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,this.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.squareVertexPositionBuffer),t.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,this.itemSize,t.FLOAT,!1,0,0),this.setMatrixUniforms(t),t.drawArrays(t.TRIANGLE_STRIP,0,this.numItems)},BackgroundInterpolationObject.prototype.initBuffersRGB=function(t){this.squareVertexPositionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.squareVertexPositionBuffer);var e=[2,2,0,0,2,0,2,0,0,0,0,0];t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),this.itemSize=3,this.numItems=4},BackgroundInterpolationObject.prototype.initShadersRGBAnimate=function(t){var e=t.createShader(t.VERTEX_SHADER);t.shaderSource(e,RGBBackgroundInterpolationVertexShaderSrc),t.compileShader(e);for(var i=t.createShader(t.FRAGMENT_SHADER),a="if (false) {} ",r=0;r<this.entity.length;r++)a+=" else if (indexA == "+r+".0) { vaa = "+this.entity[r].toLowerCase()+"; } ";a+=" if (false) {} ";for(var r=0;r<this.entity.length;r++)a+=" else if (indexB == "+r+".0) { vbb = "+this.entity[r].toLowerCase()+"; } ";var o=RGBBackgroundInterpolationFragmentShaderSrc.replace("FUNCIONES",a);t.shaderSource(i,o),t.compileShader(i),this.shaderProgram=t.createProgram();var n=this.shaderProgram;t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||console.log("Could not initialise shaders for "+this.entity),t.useProgram(n),n.vertexPositionAttribute=t.getAttribLocation(n,"aVertexPosition"),t.enableVertexAttribArray(n.vertexPositionAttribute),n.textureCoordAttribute=t.getAttribLocation(n,"aTextureCoord"),t.enableVertexAttribArray(n.textureCoordAttribute),n.pMatrixUniform=t.getUniformLocation(n,"uPMatrix"),n.mvMatrixUniform=t.getUniformLocation(n,"uMVMatrix")},BackgroundInterpolationObject.prototype.setMatrixUniforms=function(t){t.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),t.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.mvMatrix)};